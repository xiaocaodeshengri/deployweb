{"remainingRequest":"D:\\workFiles\\deployweb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\workFiles\\deployweb\\src\\components\\environment\\Device.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\workFiles\\deployweb\\src\\components\\environment\\Device.vue","mtime":1583747397520},{"path":"D:\\workFiles\\deployweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workFiles\\deployweb\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\workFiles\\deployweb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\workFiles\\deployweb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nexport default {\n  props: ['categorys'],\n  data() {\n    return {\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      editDeviceFlag: false,\n      dialogFormVisible: false,\n      category: '',\n      rackId: '',\n      racks: [],\n      deviceTypes: [\n          {'key': '服务器', 'value': '服务器'},\n          {'key': '交换机', 'value': '网络设备-交换机'},\n          {'key': '负载均衡', 'value': '网络设备-负载均衡'},\n          {'key': '防火墙', 'value': '网络设备-防火墙'},\n      ],\n      deviceForm: {\n        id: '',\n        name: '',\n        category: '',\n        rack_id: '',\n        u_location: '',\n        sn: '',\n        device_type: '',\n        property_name: '',\n        hw: '',\n        hdm_ip: '',\n        mgt_ip: '',\n        usage: '',\n        remark: '',\n        extra: '',\n        username: '',\n        password: ''\n      },\n      rules: {\n        name: [\n          { required: true, message: '请输入设备名称', trigger: 'blur' },\n          { min: 1, max: 60, message: '长度在 1 到 60 个字符', trigger: 'blur' }\n        ],\n        category: [\n          { required: true, message: '请输入所属项目组', trigger: 'blur' },\n          { min: 1, max: 15, message: '长度在 1 到 15 个字符', trigger: 'blur' }\n        ],\n        rack_id: [\n          { required: true, message: '请选择所在机柜', trigger: 'blur' }\n        ],\n        device_type: [\n          { required: true, message: '请选择设备类型', trigger: 'blur' }\n        ],\n        mgt_ip: [\n          { required: true, message: '请输入设备管理IP', trigger: 'blur' },\n          { min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur' }\n        ],\n      },\n      tableDeviceData: []\n    }\n  },\n  mounted() {\n    this.deviceList(this.category, this.rackId);\n    this.rackList();\n  },\n  methods: {\n    getRole(num){\n      this.role = localStorage.getItem(\"role\")\n      if(this.role >= num){\n        return true\n      }else{\n        return false\n      }\n    },\n    rackList(){\n      this.$axios.get(this.$api.rackList, \n      {\n        params: {page: 1, size: 100}\n      }).then((response) => {\n          this.racks = response.data['res']\n      })\n    },\n    deviceList(category, rackId){\n      this.$axios.get(this.$api.deviceList, \n      {\n        params: {page: this.currentPage, size: this.pageSize, category: category, rack_id: rackId}\n      }).then((response) => {\n          this.tableDeviceData = response.data['res']\n          this.total = response.data['total']\n      })\n    },\n    handleSizeChange(val){\n      this.pageSize = val;\n      this.deviceList(this.category, this.rackId)\n    },\n    handleCurrentChange(val){\n      this.currentPage = val;\n      this.deviceList(this.category, this.rackId)\n    },\n    filterByCategory(){\n        this.deviceList(this.category, this.rackId)\n    },\n    filterByRack(){\n        this.deviceList(this.category, this.rackId)\n    },\n    refreshList(){\n        this.currentPage = 1;\n        this.rackId = null;\n        this.category = null;\n        this.deviceList(this.category, this.rackId);\n    },\n    initDeviceForm(){\n      this.deviceForm.name = null,\n      this.deviceForm.category = localStorage.getItem('category'),\n      this.deviceForm.rack_id = null,\n      this.deviceForm.u_location = null,\n      this.deviceForm.sn = null,\n      this.deviceForm.device_type = null,\n      this.deviceForm.property_name = null,\n      this.deviceForm.hw = null,\n      this.deviceForm.hdm_ip = null,\n      this.deviceForm.mgt_ip = null,\n      this.deviceForm.usage = null,\n      this.deviceForm.remark = null,\n      this.deviceForm.username = 'root',\n      this.deviceForm.password = null\n    },\n    addBtn(){\n      this.initDeviceForm()\n      this.editDeviceFlag = false\n      this.dialogFormVisible = true\n    },\n    editDevice(id){\n      this.editDeviceFlag = true\n      this.$axios.get((this.$api.deviceManage + '/' + id)).then((response) => {\n          this.deviceForm.id = id\n          this.deviceForm.name = response.data['res']['name']\n          this.deviceForm.category = response.data['res']['category']\n          this.deviceForm.rack_id = response.data['res']['rack_id']\n          this.deviceForm.u_location = response.data['res']['u_location']\n          this.deviceForm.sn = response.data['res']['sn']\n          this.deviceForm.device_type = response.data['res']['device_type']\n          this.deviceForm.property_name = response.data['res']['property_name']\n          this.deviceForm.hw = response.data['res']['hw']\n          this.deviceForm.hdm_ip = response.data['res']['hdm_ip']\n          this.deviceForm.mgt_ip = response.data['res']['mgt_ip']\n          this.deviceForm.usage = response.data['res']['usage']\n          this.deviceForm.remark = response.data['res']['remark']\n          this.deviceForm.username = response.data['res']['username']\n          this.deviceForm.password = response.data['res']['password']\n      })\n      this.dialogFormVisible = true\n    },\n    deleteDevice(id){\n      this.$axios.delete((this.$api.deviceManage + '/' + id)).then((response) => {\n        if (this.messageShow(this, response)){\n          this.deviceList(this.category, this.rackId);\n        }\n      }).catch((error) => {\n        this.errorMessageShow(this, error.response);\n      })\n    },\n    addDeviceBtn(){\n      let data = {\n        \"name\": this.deviceForm.name,\n        \"category\": this.deviceForm.category,\n        \"rack_id\": this.deviceForm.rack_id,\n        \"u_location\": this.deviceForm.u_location,\n        \"sn\": this.deviceForm.sn,\n        \"device_type\": this.deviceForm.device_type,\n        \"property_name\": this.deviceForm.property_name,\n        \"hw\": this.deviceForm.hw,\n        \"hdm_ip\": this.deviceForm.hdm_ip,\n        \"mgt_ip\": this.deviceForm.mgt_ip,\n        \"usage\": this.deviceForm.usage,\n        \"remark\": this.deviceForm.remark,\n        \"username\": this.deviceForm.username,\n        \"password\": this.deviceForm.password\n      }\n      this.$axios.post(this.$api.deviceManage, data).then((response) => {\n        if (this.messageShow(this, response)){\n          this.dialogFormVisible = false;\n          this.deviceList(this.category, this.rackId);\n        }\n      }).catch((error) => {\n        this.errorMessageShow(this, error.response);\n      })\n    },\n    editDeviceBtn(id){\n      let data = {\n        \"name\": this.deviceForm.name,\n        \"category\": this.deviceForm.category,\n        \"rack_id\": this.deviceForm.rack_id,\n        \"u_location\": this.deviceForm.u_location,\n        \"sn\": this.deviceForm.sn,\n        \"device_type\": this.deviceForm.device_type,\n        \"property_name\": this.deviceForm.property_name,\n        \"hw\": this.deviceForm.hw,\n        \"hdm_ip\": this.deviceForm.hdm_ip,\n        \"mgt_ip\": this.deviceForm.mgt_ip,\n        \"usage\": this.deviceForm.usage,\n        \"remark\": this.deviceForm.remark,\n        \"username\": this.deviceForm.username,\n        \"password\": this.deviceForm.password\n      }\n      this.$axios.put((this.$api.deviceManage + '/' + id), data).then((response) => {\n        if (this.messageShow(this, response)){\n          this.dialogFormVisible = false;\n          this.editDeviceFlag = false;\n          this.deviceList(this.category, this.rackId);\n        }\n      }).catch((error) => {\n        this.errorMessageShow(this, error.response);\n      })\n    },\n    cancelBtn(){\n      this.dialogFormVisible = false;\n      this.initDeviceForm();\n      this.editDeviceFlag = false;\n    },\n    querySearch(queryString, cb) {\n      var categorys = this.categorys;\n      var results = queryString ? categorys.filter(this.createFilter(queryString)) : categorys;\n      cb(results);\n    },\n    createFilter(queryString) {\n      return (category) => {\n        return (category.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\n      };\n    }\n  }\n}\n",{"version":3,"sources":["Device.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Device.vue","sourceRoot":"src/components/environment","sourcesContent":["<template>\r\n    <div>\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"3\"><h2>设备信息</h2></el-col>\r\n          <el-col :span=\"3\" :offset=\"12\">\r\n            <el-select v-model=\"category\" filterable placeholder=\"根据项目筛选\" size=\"small\" v-on:change=\"filterByCategory\"\r\n            style=\"padding-top:19px\">\r\n              <el-option\r\n                v-for=\"item in categorys\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.name\">\r\n              </el-option>\r\n            </el-select>          \r\n          </el-col>\r\n          <el-col :span=\"3\">\r\n            <el-select v-model=\"rackId\" filterable placeholder=\"根据机柜筛选\" size=\"small\" v-on:change=\"filterByRack\"\r\n            style=\"padding-top:19px\">\r\n              <el-option\r\n                v-for=\"item in racks\"\r\n                :key=\"item.id\"\r\n                :label=\"item.name\"\r\n                :value=\"item.id\">\r\n              </el-option>\r\n            </el-select>\r\n          </el-col>\r\n          <el-col :span=\"1\" style=\"padding-top:19px\">\r\n                <el-button type=\"primary\" icon=\"el-icon-refresh\" size=\"mini\" plain\r\n                            @click.native=\"refreshList\">\r\n                </el-button>\r\n          </el-col>\r\n          <el-col :span=\"1\" style=padding-top:18px>\r\n            <el-button @click.native=\"addBtn()\" type=\"primary\" icon=\"el-icon-plus\" size=\"small\" circle plain></el-button>\r\n          </el-col>\r\n        </el-row>\r\n        <el-divider></el-divider>\r\n        <el-table\r\n            :data=\"tableDeviceData\"\r\n            stripe\r\n            style=\"width: 100%\">\r\n            <el-table-column type=\"expand\">\r\n                <template slot-scope=\"props\">\r\n                    <el-form label-position=\"left\" inline class=\"demo-table-expand\">\r\n                        <el-form-item label=\"用户名\">\r\n                            <span>{{ props.row.username }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"密码\">\r\n                            <span>{{ props.row.password }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"HDM\">\r\n                            <span>{{ props.row.hdm_ip }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"序列号\">\r\n                            <span>{{ props.row.sn }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"资产名称\">\r\n                            <span>{{ props.row.property_name }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"硬件配置\">\r\n                            <span>{{ props.row.hw }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"用途\">\r\n                            <span>{{ props.row.usage }}</span>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"备注\">\r\n                            <span>{{ props.row.remark }}</span>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column\r\n            type=\"index\"\r\n            label=\"No.\"\r\n            width=\"50\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"name\"\r\n            label=\"名称\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"category\"\r\n            label=\"项目组\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"rack\"\r\n            label=\"所在机柜\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"u_location\"\r\n            label=\"位置\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"mgt_ip\"\r\n            label=\"管理IP\">\r\n            </el-table-column>\r\n            <el-table-column\r\n            prop=\"device_type\"\r\n            label=\"设备类型\">\r\n            </el-table-column>\r\n            <el-table-column label=\"操作\" width=\"200\">\r\n                <template slot-scope=\"scope\">\r\n                    <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"mini\" circle plain\r\n                                @click.native=\"editDevice(tableDeviceData[scope.$index]['id'])\">\r\n                    </el-button>\r\n                    <el-button type=\"danger\" icon=\"el-icon-delete\" size=\"mini\" circle plain\r\n                                @click.native=\"sureView(deleteDevice,tableDeviceData[scope.$index]['id'],tableDeviceData[scope.$index]['name'])\">\r\n                    </el-button>\r\n                </template>\r\n            </el-table-column>\r\n        </el-table>\r\n\r\n        <el-row type=\"flex\" justify=\"end\">\r\n          <el-col :span=\"12\" style=padding-top:24px>\r\n            <el-pagination\r\n              @size-change=\"handleSizeChange\"\r\n              @current-change=\"handleCurrentChange\"\r\n              :current-page=\"currentPage\"\r\n              :page-sizes=\"[10, 20, 50, 100]\"\r\n              :page-size=\"pageSize\"\r\n              layout=\"total, sizes, prev, pager, next, jumper\"\r\n              :total=\"total\">\r\n            </el-pagination>\r\n          </el-col>\r\n        </el-row>\r\n        \r\n        <el-dialog title=\"设备配置\" :visible.sync=\"dialogFormVisible\" width=\"50%\">\r\n          <el-form :model=\"deviceForm\" :rules=\"rules\" ref=\"deviceForm\" label-width=\"150px\" class=\"demo-deviceForm\"  label-position=\"top\">\r\n              <el-form-item label=\"名称\" prop=\"name\" size=\"small\">\r\n                  <el-input v-model=\"deviceForm.name\" class=\"commonwidth\"></el-input>\r\n              </el-form-item>\r\n              <el-row :gutter=\"10\">\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"项目组\" prop=\"category\" size=\"small\">\r\n                      <el-autocomplete\r\n                      class=\"inline-input\"\r\n                      v-model=\"deviceForm.category\"\r\n                      :fetch-suggestions=\"querySearch\"\r\n                      placeholder=\"请输入所属项目组\"\r\n                      :trigger-on-focus=\"true\"\r\n                      >\r\n                      </el-autocomplete>\r\n                      <!-- <el-input v-model=\"deviceForm.category\"></el-input> -->\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"所在机柜\" prop=\"rack_id\" size=\"small\">\r\n                        <el-select v-model=\"deviceForm.rack_id\" placeholder=\"请选择机柜\">\r\n                        <el-option\r\n                            v-for=\"item in racks\"\r\n                            :key=\"item.id\"\r\n                            :label=\"item.name\"\r\n                            :value=\"item.id\">\r\n                        </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"设备类型\" prop=\"device_type\" size=\"small\">\r\n                        <el-select v-model=\"deviceForm.device_type\" placeholder=\"请选择设备类型\">\r\n                        <el-option\r\n                            v-for=\"item in deviceTypes\"\r\n                            :key=\"item.key\"\r\n                            :label=\"item.value\"\r\n                            :value=\"item.value\">\r\n                        </el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                  </el-col>\r\n              </el-row>\r\n              <el-row :gutter=\"10\">\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"管理IP\" prop=\"mgt_ip\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.mgt_ip\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"HDM\" prop=\"hdm_ip\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.hdm_ip\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"6\">\r\n                    <el-form-item label=\"所在位置\" prop=\"u_location\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.u_location\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n              </el-row>\r\n              <el-row :gutter=\"10\">\r\n                  <el-col :span=\"9\">\r\n                    <el-form-item label=\"管理用户名\" prop=\"username\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.username\" placeholder=\"root\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"9\">\r\n                    <el-form-item label=\"后台密码\" prop=\"password\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.password\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n              </el-row>\r\n              <el-row :gutter=\"10\">\r\n                  <el-col :span=\"9\">\r\n                    <el-form-item label=\"资产名称\" prop=\"property_name\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.property_name\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n                  <el-col :span=\"9\">\r\n                    <el-form-item label=\"序列号\" prop=\"sn\" size=\"small\">\r\n                        <el-input v-model=\"deviceForm.sn\"></el-input>\r\n                    </el-form-item>\r\n                  </el-col>\r\n              </el-row>\r\n              <el-form-item label=\"硬件配置\" prop=\"hw\" size=\"small\">\r\n                  <el-input type=\"textarea\" v-model=\"deviceForm.hw\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"用途\" prop=\"usage\" size=\"small\">\r\n                  <el-input type=\"textarea\" v-model=\"deviceForm.usage\"></el-input>\r\n              </el-form-item>\r\n              <el-form-item label=\"备注\" prop=\"remark\" size=\"small\">\r\n                  <el-input type=\"textarea\" v-model=\"deviceForm.remark\"></el-input>\r\n              </el-form-item>\r\n            </el-form>\r\n            <div slot=\"footer\" class=\"dialog-footer\">\r\n              <el-button @click=\"cancelBtn()\">取 消</el-button>\r\n              <el-button v-if=\"editDeviceFlag === true\" type=\"primary\" @click=\"editDeviceBtn(deviceForm['id'])\">确 定</el-button>\r\n              <el-button v-else type=\"primary\" @click=\"addDeviceBtn()\">新 建</el-button>\r\n            </div>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  export default {\r\n    props: ['categorys'],\r\n    data() {\r\n      return {\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        total: 0,\r\n        editDeviceFlag: false,\r\n        dialogFormVisible: false,\r\n        category: '',\r\n        rackId: '',\r\n        racks: [],\r\n        deviceTypes: [\r\n            {'key': '服务器', 'value': '服务器'},\r\n            {'key': '交换机', 'value': '网络设备-交换机'},\r\n            {'key': '负载均衡', 'value': '网络设备-负载均衡'},\r\n            {'key': '防火墙', 'value': '网络设备-防火墙'},\r\n        ],\r\n        deviceForm: {\r\n          id: '',\r\n          name: '',\r\n          category: '',\r\n          rack_id: '',\r\n          u_location: '',\r\n          sn: '',\r\n          device_type: '',\r\n          property_name: '',\r\n          hw: '',\r\n          hdm_ip: '',\r\n          mgt_ip: '',\r\n          usage: '',\r\n          remark: '',\r\n          extra: '',\r\n          username: '',\r\n          password: ''\r\n        },\r\n        rules: {\r\n          name: [\r\n            { required: true, message: '请输入设备名称', trigger: 'blur' },\r\n            { min: 1, max: 60, message: '长度在 1 到 60 个字符', trigger: 'blur' }\r\n          ],\r\n          category: [\r\n            { required: true, message: '请输入所属项目组', trigger: 'blur' },\r\n            { min: 1, max: 15, message: '长度在 1 到 15 个字符', trigger: 'blur' }\r\n          ],\r\n          rack_id: [\r\n            { required: true, message: '请选择所在机柜', trigger: 'blur' }\r\n          ],\r\n          device_type: [\r\n            { required: true, message: '请选择设备类型', trigger: 'blur' }\r\n          ],\r\n          mgt_ip: [\r\n            { required: true, message: '请输入设备管理IP', trigger: 'blur' },\r\n            { min: 1, max: 20, message: '长度在 1 到 20 个字符', trigger: 'blur' }\r\n          ],\r\n        },\r\n        tableDeviceData: []\r\n      }\r\n    },\r\n    mounted() {\r\n      this.deviceList(this.category, this.rackId);\r\n      this.rackList();\r\n    },\r\n    methods: {\r\n      getRole(num){\r\n        this.role = localStorage.getItem(\"role\")\r\n        if(this.role >= num){\r\n          return true\r\n        }else{\r\n          return false\r\n        }\r\n      },\r\n      rackList(){\r\n        this.$axios.get(this.$api.rackList, \r\n        {\r\n          params: {page: 1, size: 100}\r\n        }).then((response) => {\r\n            this.racks = response.data['res']\r\n        })\r\n      },\r\n      deviceList(category, rackId){\r\n        this.$axios.get(this.$api.deviceList, \r\n        {\r\n          params: {page: this.currentPage, size: this.pageSize, category: category, rack_id: rackId}\r\n        }).then((response) => {\r\n            this.tableDeviceData = response.data['res']\r\n            this.total = response.data['total']\r\n        })\r\n      },\r\n      handleSizeChange(val){\r\n        this.pageSize = val;\r\n        this.deviceList(this.category, this.rackId)\r\n      },\r\n      handleCurrentChange(val){\r\n        this.currentPage = val;\r\n        this.deviceList(this.category, this.rackId)\r\n      },\r\n      filterByCategory(){\r\n          this.deviceList(this.category, this.rackId)\r\n      },\r\n      filterByRack(){\r\n          this.deviceList(this.category, this.rackId)\r\n      },\r\n      refreshList(){\r\n          this.currentPage = 1;\r\n          this.rackId = null;\r\n          this.category = null;\r\n          this.deviceList(this.category, this.rackId);\r\n      },\r\n      initDeviceForm(){\r\n        this.deviceForm.name = null,\r\n        this.deviceForm.category = localStorage.getItem('category'),\r\n        this.deviceForm.rack_id = null,\r\n        this.deviceForm.u_location = null,\r\n        this.deviceForm.sn = null,\r\n        this.deviceForm.device_type = null,\r\n        this.deviceForm.property_name = null,\r\n        this.deviceForm.hw = null,\r\n        this.deviceForm.hdm_ip = null,\r\n        this.deviceForm.mgt_ip = null,\r\n        this.deviceForm.usage = null,\r\n        this.deviceForm.remark = null,\r\n        this.deviceForm.username = 'root',\r\n        this.deviceForm.password = null\r\n      },\r\n      addBtn(){\r\n        this.initDeviceForm()\r\n        this.editDeviceFlag = false\r\n        this.dialogFormVisible = true\r\n      },\r\n      editDevice(id){\r\n        this.editDeviceFlag = true\r\n        this.$axios.get((this.$api.deviceManage + '/' + id)).then((response) => {\r\n            this.deviceForm.id = id\r\n            this.deviceForm.name = response.data['res']['name']\r\n            this.deviceForm.category = response.data['res']['category']\r\n            this.deviceForm.rack_id = response.data['res']['rack_id']\r\n            this.deviceForm.u_location = response.data['res']['u_location']\r\n            this.deviceForm.sn = response.data['res']['sn']\r\n            this.deviceForm.device_type = response.data['res']['device_type']\r\n            this.deviceForm.property_name = response.data['res']['property_name']\r\n            this.deviceForm.hw = response.data['res']['hw']\r\n            this.deviceForm.hdm_ip = response.data['res']['hdm_ip']\r\n            this.deviceForm.mgt_ip = response.data['res']['mgt_ip']\r\n            this.deviceForm.usage = response.data['res']['usage']\r\n            this.deviceForm.remark = response.data['res']['remark']\r\n            this.deviceForm.username = response.data['res']['username']\r\n            this.deviceForm.password = response.data['res']['password']\r\n        })\r\n        this.dialogFormVisible = true\r\n      },\r\n      deleteDevice(id){\r\n        this.$axios.delete((this.$api.deviceManage + '/' + id)).then((response) => {\r\n          if (this.messageShow(this, response)){\r\n            this.deviceList(this.category, this.rackId);\r\n          }\r\n        }).catch((error) => {\r\n          this.errorMessageShow(this, error.response);\r\n        })\r\n      },\r\n      addDeviceBtn(){\r\n        let data = {\r\n          \"name\": this.deviceForm.name,\r\n          \"category\": this.deviceForm.category,\r\n          \"rack_id\": this.deviceForm.rack_id,\r\n          \"u_location\": this.deviceForm.u_location,\r\n          \"sn\": this.deviceForm.sn,\r\n          \"device_type\": this.deviceForm.device_type,\r\n          \"property_name\": this.deviceForm.property_name,\r\n          \"hw\": this.deviceForm.hw,\r\n          \"hdm_ip\": this.deviceForm.hdm_ip,\r\n          \"mgt_ip\": this.deviceForm.mgt_ip,\r\n          \"usage\": this.deviceForm.usage,\r\n          \"remark\": this.deviceForm.remark,\r\n          \"username\": this.deviceForm.username,\r\n          \"password\": this.deviceForm.password\r\n        }\r\n        this.$axios.post(this.$api.deviceManage, data).then((response) => {\r\n          if (this.messageShow(this, response)){\r\n            this.dialogFormVisible = false;\r\n            this.deviceList(this.category, this.rackId);\r\n          }\r\n        }).catch((error) => {\r\n          this.errorMessageShow(this, error.response);\r\n        })\r\n      },\r\n      editDeviceBtn(id){\r\n        let data = {\r\n          \"name\": this.deviceForm.name,\r\n          \"category\": this.deviceForm.category,\r\n          \"rack_id\": this.deviceForm.rack_id,\r\n          \"u_location\": this.deviceForm.u_location,\r\n          \"sn\": this.deviceForm.sn,\r\n          \"device_type\": this.deviceForm.device_type,\r\n          \"property_name\": this.deviceForm.property_name,\r\n          \"hw\": this.deviceForm.hw,\r\n          \"hdm_ip\": this.deviceForm.hdm_ip,\r\n          \"mgt_ip\": this.deviceForm.mgt_ip,\r\n          \"usage\": this.deviceForm.usage,\r\n          \"remark\": this.deviceForm.remark,\r\n          \"username\": this.deviceForm.username,\r\n          \"password\": this.deviceForm.password\r\n        }\r\n        this.$axios.put((this.$api.deviceManage + '/' + id), data).then((response) => {\r\n          if (this.messageShow(this, response)){\r\n            this.dialogFormVisible = false;\r\n            this.editDeviceFlag = false;\r\n            this.deviceList(this.category, this.rackId);\r\n          }\r\n        }).catch((error) => {\r\n          this.errorMessageShow(this, error.response);\r\n        })\r\n      },\r\n      cancelBtn(){\r\n        this.dialogFormVisible = false;\r\n        this.initDeviceForm();\r\n        this.editDeviceFlag = false;\r\n      },\r\n      querySearch(queryString, cb) {\r\n        var categorys = this.categorys;\r\n        var results = queryString ? categorys.filter(this.createFilter(queryString)) : categorys;\r\n        cb(results);\r\n      },\r\n      createFilter(queryString) {\r\n        return (category) => {\r\n          return (category.value.toLowerCase().indexOf(queryString.toLowerCase()) === 0);\r\n        };\r\n      }\r\n    }\r\n  }\r\n</script>"]}]}